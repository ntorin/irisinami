"use strict";function _interopDefault(e){return e&&"object"==typeof e&&"default"in e?e.default:e}Object.defineProperty(exports,"__esModule",{value:!0});var React=_interopDefault(require("react")),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},_extends=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},MetroTween=function(){function e(){classCallCheck(this,e)}return e.fromTo=function(t,n,i,o){return new Promise(function(r,a){t&&(void 0===i?"undefined":_typeof(i))===e.typeDefs.OBJECT&&(void 0===o?"undefined":_typeof(o))===e.typeDefs.OBJECT||a("incorrect args"),("undefined"==typeof window?"undefined":_typeof(window))===e.typeDefs.UNDEFINED&&a("no window"),0===Object.values(i).length&&a("incorrect fromProps args"),0===Object.values(o).length&&a("incorrect toProps args"),(void 0===n?"undefined":_typeof(n))===e.typeDefs.NUMBER&&n||a("incorrect duration arg");var s=e.getEasingFromProps(i,o),u=s.easingEquationFrom,c=s.easingEquationTo,l=0,p=Object.prototype.hasOwnProperty,f=[],m=[];Object.entries(i).forEach(function(t){var n=t[0],i=t[1];n===e.typeDefs.EASE&&(void 0===i?"undefined":_typeof(i))===e.typeDefs.STRING||(p.call(e.keyMap,n)?f.push({key:n,value:i,handler:e.keyMap[n]}):console.log("invalid from key:",n,"handler:",e.keyMap[n].value))}),Object.entries(o).forEach(function(t){var n=t[0],i=t[1];if(n!==e.typeDefs.EASE||(void 0===i?"undefined":_typeof(i))!==e.typeDefs.STRING)if(n===e.typeDefs.DELAY&&(void 0===i?"undefined":_typeof(i))===e.typeDefs.NUMBER)l=i;else if((void 0===i?"undefined":_typeof(i))===e.typeDefs.NUMBER||(void 0===i?"undefined":_typeof(i))===e.typeDefs.STRING){if(!p.call(e.keyMap,n))return void console.log("invalid to key:",n);m.push({key:n,value:i,handler:e.keyMap[n]})}});var d={from:f,to:m},y=1e3*n,h=1e3*l;e.applyAnimation(t,y,u),d.from.forEach(function(n){e.applyStyles(t,n)}),window.requestAnimationFrame(function(){setTimeout(function(){e.applyAnimation(t,y,c),d.to.forEach(function(n){e.applyStyles(t,n)}),setTimeout(function(){e.resetStyles(t),r()},y)},h)})})},e}();MetroTween.keyMap={x:function(e){return"translateX("+e+"px)"},y:function(e){return"translateY("+e+"px)"},skewX:function(e){return"skewX("+e+")"},skewY:function(e){return"skewY("+e+")"},scaleX:function(e){return"scaleX("+e+")"},scaleY:function(e){return"scaleY("+e+")"},rotation:function(e){return"rotate("+e+"deg)"},scale:function(e){return"scale("+e+")"},opacity:null},MetroTween.easeEquationMap={easeInSine:"cubic-bezier(0.47, 0, 0.745, 0.715)",easeOutSine:"cubic-bezier(0.39, 0.575, 0.565, 1)",easeInOutSine:"cubic-bezier(0.445, 0.05, 0.55, 0.95)",easeInQuad:"cubic-bezier(0.55, 0.085, 0.68, 0.53)",easeOutQuad:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",easeInOutQuad:"cubic-bezier(0.455, 0.03, 0.515, 0.955)",easeInCubic:"cubic-bezier(0.55, 0.055, 0.675, 0.19)",easeOutCubic:"cubic-bezier(0.215, 0.61, 0.355, 1)",easeInOutCubic:"cubic-bezier(0.645, 0.045, 0.355, 1)",easeInQuart:"cubic-bezier(0.645, 0.045, 0.355, 1)",easeOutQuart:"cubic-bezier(0.165, 0.84, 0.44, 1)",easeInOutQuart:"cubic-bezier(0.77, 0, 0.175, 1)",easeInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",easeOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",easeInOutQuint:"cubic-bezier(0.86, 0, 0.07, 1)",easeInExpo:"cubic-bezier(0.95, 0.05, 0.795, 0.035)",easeOutExpo:"cubic-bezier(0.19, 1, 0.22, 1)",easeInOutExpo:"cubic-bezier(1, 0, 0, 1)",easeInCirc:"cubic-bezier(0.6, 0.04, 0.98, 0.335)",easeOutCirc:"cubic-bezier(0.075, 0.82, 0.165, 1)",easeInOutCirc:"cubic-bezier(0.785, 0.135, 0.15, 0.86)",easeInBack:"cubic-bezier(0.6, -0.28, 0.735, 0.045)",easeOutBack:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",easeInOutBack:"cubic-bezier(0.68, -0.55, 0.265, 1.55)"},MetroTween.transformAgents=["webkitTransform","MozTransform","msTransform","OTransform","transform"],MetroTween.transitionAgents=["-webkit-transition","-moz-transition","-o-transition","transition"],MetroTween.typeDefs={UNDEFINED:"undefined",STRING:"string",NUMBER:"number",OBJECT:"object",DELAY:"delay",EASE:"ease",DEFAULT_EASE:"linear",DEFAULT_TWEEN_PROP:"all",DEFAULT_TIME_UNIT:"ms"},MetroTween.getEasingFromProps=function(e,t){var n=Object.prototype.hasOwnProperty,i=[{p:e,equation:MetroTween.typeDefs.DEFAULT_EASE},{p:t,equation:MetroTween.typeDefs.DEFAULT_EASE}];return i.forEach(function(e){n.call(e.p,MetroTween.typeDefs.EASE)&&n.call(MetroTween.easeEquationMap,e.p.ease)&&(e.equation=MetroTween.easeEquationMap[e.p.ease])}),{easingEquationFrom:i[0].equation,easingEquationTo:i[1].equation}},MetroTween.applyAnimation=function(e,t,n){MetroTween.transitionAgents.forEach(function(i){return e.style[i]=MetroTween.typeDefs.DEFAULT_TWEEN_PROP+" "+t+MetroTween.typeDefs.DEFAULT_TIME_UNIT+" "+n})},MetroTween.applyStyles=function(e,t){e.style[t.key]=t.value,t.handler?MetroTween.transformAgents.forEach(function(n){return e.style[n]=t.handler(t.value)}):e.style[t.key]=t.value},MetroTween.resetStyles=function(e){e.style.transition="",MetroTween.transformAgents.forEach(function(t){return e.style[t]=""})};var MetroHoc=function(e){var t,n;return n=t=function(t){function n(){return classCallCheck(this,n),possibleConstructorReturn(this,t.apply(this,arguments))}return inherits(n,t),n.prototype.getLongestAnimationInSequence=function(e){return Math.max.apply(Math,this.props.sequence.map(function(t){return t.animation[e].time+t.animation[e].delay}))},n.prototype.isThisTheLongestAnimation=function(e,t){var n=this.getLongestAnimationInSequence(t);return e[t].time+e[t].delay>=n},n.prototype.applySequenceEndIfLastInSequence=function(e,t,n){var i=this.getLongestAnimationInSequence(n),o=!0;return t.forEach(function(t,r){t.animation[n].time+t.animation[n].delay===i&&r>e&&(o=!1)}),o},n.prototype.componentWillEnter=function(e){var t=this,n=this.container;this.props.sequence[this.props.itemIndex].animating=!0,MetroTween.fromTo(n,this.props.animation.in.time,this.props.animation.willEnter.from,_extends({},this.props.animation.willEnter.to,{delay:this.props.animation.in.delay})).then(function(){t.isThisTheLongestAnimation(t.props.animation,"in")&&t.applySequenceEndIfLastInSequence(t.props.index,t.props.sequence,"in")&&t.props.onMount&&t.props.onMount(),t.props.sequence[t.props.itemIndex].animating=!1,e()})},n.prototype.componentWillLeave=function(e){var t=this,n=this.container,i=this.getLongestAnimationInSequence("out")-(this.props.animation.out.time+this.props.animation.out.delay);this.props.sequence[this.props.itemIndex].animating=!0,MetroTween.fromTo(n,this.props.animation.out.time,this.props.animation.willLeave.from,_extends({},this.props.animation.willLeave.to,{delay:this.props.animation.out.delay})).then(function(){setTimeout(function(){t.isThisTheLongestAnimation(t.props.animation,"out")&&t.applySequenceEndIfLastInSequence(t.props.index,t.props.sequence,"out")&&t.props.onUnmount&&t.props.onUnmount(),t.props.sequence[t.props.itemIndex].animating=!1,e()},1e3*i)})},n.prototype.render=function(){var t=this;return React.createElement(this.props.wrapperType,{ref:function(e){return t.container=e}},React.createElement(e,this.props))},n}(React.Component),t.defaultProps={wrapperType:"div"},n},delayedVerticalPreset=function(e,t,n,i,o){for(var r=[],a={willEnter:{from:{opacity:0,y:50},to:{opacity:1,y:0}}},s={willLeave:{from:{opacity:1,y:0},to:{opacity:0,y:50}}},u=0;u<n;u++)r.push(_extends({in:{time:i,delay:u*o},out:{time:i,delay:u*o}},s,a));return t&&r.splice(t,0,_extends({in:{time:i,delay:0},out:{time:i,delay:0}},s,a)),r},dominoPreset=function(e,t,n,i,o){var r=t||0,a=[],s=0,u=1,c={willLeave:{from:{opacity:1,skewX:"0deg",y:0},to:{opacity:0,skewX:"-10deg",y:20}}},l={willEnter:{from:{opacity:0,skewX:"-10deg",y:20},to:{opacity:1,skewX:"0deg",y:0}}};if("multi"===e){for(var p=r,f=r;f>0;f--)a.push(_extends({in:{time:2*i,delay:o*p*2},out:{time:2*i,delay:o*p*2}},c,l)),p-=1;for(var m=r+1;m<n;m++)a.push(_extends({in:{time:2*i,delay:o*s*2},out:{time:2*i,delay:o*s*2}},c,l)),s+=1}else if("backwards"===e){for(var d=r,y=r;y>0;y--)a.push(_extends({in:{time:i,delay:o*d},out:{time:i,delay:o*d}},c,l)),d-=1;for(var h=n-1,b=n;b>r;b--)a.push(_extends({in:{time:i,delay:o*h},out:{time:i,delay:o*h}},c,l)),h-=1}else for(var E=0;E<n;E++)if(E<r){var w=E*o+(n-r)*o;a.push(_extends({in:{time:i,delay:w},out:{time:i,delay:w}},c,l))}else E>r&&(a.push(_extends({in:{time:i,delay:o*u},out:{time:i,delay:o*u}},c,l)),u+=1);return a.splice(r,0,_extends({in:{time:i,delay:0},out:{time:i,delay:0}},c,l)),a},animations={domino:dominoPreset,delayedVertical:delayedVerticalPreset},defaultAnimation={animation:{out:{time:.4,delay:0},in:{time:.4,delay:0},willEnter:{from:{opacity:0},to:{opacity:1,ease:"easeInOut"}},willLeave:{from:{opacity:1},to:{opacity:0}}}},metroContainer=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=_extends({},t||defaultAnimation),o=_extends({},i,{key:0,itemIndex:0,sequence:[_extends({},i)]});return React.createElement(Metro.animation,_extends({},o,n),e)},metroBindContainer=function(e,t,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return e?Metro.container(t,n,i):null},combineAnimations=function(e,t){return t?{out:_extends({},e.out,t.out),in:_extends({},e.in,t.in),willEnter:{from:_extends({},e.willEnter&&e.willEnter.from,t.willEnter&&t.willEnter.from),to:_extends({},e.willEnter&&e.willEnter.to,t.willEnter&&t.willEnter.to)},willLeave:{from:_extends({},e.willLeave&&e.willLeave.from,t.willLeave&&t.willLeave.from),to:_extends({},e.willLeave&&e.willLeave.to,t.willLeave&&t.willLeave.to)}}:e},metroSequence=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i={animation:n?combineAnimations(defaultAnimation.animation,n.animation):defaultAnimation.animation},o=e.map(function(e,n){var o=combineAnimations(i.animation,t[n]),r=_extends({},i,{animation:o});return _extends({},r,{content:e})});return o.map(function(e,t){return _extends({key:t,itemIndex:t},e,{sequence:o})})},metroAnimation=MetroHoc(function(e){function t(){return classCallCheck(this,t),possibleConstructorReturn(this,e.apply(this,arguments))}return inherits(t,e),t.prototype.render=function(){var e=this;return React.createElement("div",{onClick:function(){var t=e.props.sequence.some(function(e){return e.animating});!e.props.onClick||t&&!e.props.enableClickDuringAnimation||e.props.onClick(e.props.content,e.props.itemIndex,t)}},this.props.children)},t}(React.Component)),generateFocusAnimationMap=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"dominoForwards",i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1,o=.75*i/t,r=[e,t,o,o+.25*i/t];if(n.includes("domino")){var a=n.split("domino")[1].toLowerCase();return animations.domino.apply(animations,[a].concat(r))}if(n.includes("delayed")){var s=n.split("delayed")[1].toLowerCase();return animations.delayedVertical.apply(animations,[s].concat(r))}return[]},Metro={sequence:metroSequence,animation:metroAnimation,container:metroContainer,bindContainer:metroBindContainer,generateFocusMap:generateFocusAnimationMap};exports.default=Metro;
